import {z} from 'zod';

export const ScanCodeInputSchema = z.object({
  code: z.string().describe('The code snippet to analyze.'),
});
export type ScanCodeInput = z.infer<typeof ScanCodeInputSchema>;

export const ScanCodeOutputSchema = z.object({
  vulnerabilities: z.array(z.object({
    line: z.number().describe('The line number of the vulnerability.'),
    vulnerability: z.string().describe('A brief description of the vulnerability (e.g., "Cross-Site Scripting (XSS)").'),
    suggestion: z.string().describe('A suggestion on how to fix the vulnerability.'),
  })).describe('A list of vulnerabilities found in the code.'),
});
export type ScanCodeOutput = z.infer<typeof ScanCodeOutputSchema>;
